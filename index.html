<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>機種リスト OCR 抽出ツール（ass外部版）</title>
<style>
  :root { color-scheme: light dark; }
  body{margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Noto Sans JP, sans-serif;}
  header{padding:16px 20px; background:#0f172a; color:#fff; position:sticky; top:0; z-index:1;}
  header h1{margin:0; font-size:18px; font-weight:700;}
  main{padding:20px; max-width:1200px; margin:0 auto;}
  .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center;}
  .card{border:1px solid #e5e7eb; border-radius:12px; padding:16px; background:#fff;}
  .muted{color:#6b7280; font-size:12px;}
  button,input{font-size:14px;}
  button{padding:8px 12px; border-radius:8px; border:1px solid #334155; background:#0ea5e9; color:#fff; cursor:pointer}
  button[disabled]{opacity:.5; cursor:not-allowed}
  .btn-secondary{background:#334155}
  table{width:100%; border-collapse:collapse; margin-top:16px; background:#0b1220; color:#fff;}
  th,td{border:1px solid #1f2937; padding:8px 10px; font-size:13px; vertical-align:top;}
  thead th{background:#0f172a; position:sticky; top:58px; z-index:1;}
  progress{width:220px; height:14px; accent-color:#22c55e;}
</style>

<!-- ライブラリ（順序固定・絶対URL） -->
<script defer src="https://unpkg.com/tesseract.js@5.1.0/dist/tesseract.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.5.136/pdf.min.js"></script>
<script defer>
  if (window.pdfjsLib) {
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.5.136/pdf.worker.min.js";
  }
</script>
<script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<!-- ★ ass.js を外部読み込み（indexと同階層想定） -->
<script defer src="ass.js"></script>
</head>

<body>
<header>
  <h1>機種リスト OCR 抽出ツール（シンプル + 精度UP）</h1>
</header>

<main>
  <div class="card">
    <div class="row" style="gap:16px; align-items:flex-end;">
      <div>
        <div class="muted">画像またはPDFを選択</div>
        <input id="imageInput" type="file" accept="image/*,application/pdf" />
      </div>
      <div>
        <div class="muted">（任意）マスターCSV（1列目：機
