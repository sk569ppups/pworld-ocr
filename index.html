<!doctype html>
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace}
textarea{width:100%;min-height:180px}
.small{font-size:12px;color:#6b7280}
.ok{color:#047857}
.warn{color:#b45309}
.err{color:#b91c1c}
</style>
</head>
<body>
<div class="wrap">
<h1>P-WORLD 機種抽出（改良版 / マスター参照）</h1>


<div class="grid">
<div class="card">
<h2>① PDF / 画像の読み込み</h2>
<div class="row">
<input id="pdfInput" type="file" accept="application/pdf,image/*" multiple />
<label><input id="forceOcr" type="checkbox"/> 強制OCR（PDFにテキストが埋まっていない場合のみ通常ON）</label>
</div>
<p class="small">PDFはまず <b>テキスト抽出</b> を試み、空の場合のみ <b>OCR（Tesseract）</b> に自動フォールバックします。</p>
</div>


<div class="card">
<h2>② マスターシート読み込み</h2>
<div class="row">
<input id="msInput" type="file" accept=".csv,.txt" />
<button id="btnFetchMs" type="button">./data/master.csv を読み込む</button>
<input id="msUrl" type="url" placeholder="任意のCSV URL（同一リポ推奨）" style="flex:1"/>
<button id="btnFetchMsUrl" type="button">URLから読み込み</button>
</div>
<p class="small">推奨：リポ内に <code>/data/master.csv</code> を置き、上のボタンで読み込み。<br>CSVは <b>1列目=正式機種名</b>（ヘッダ可）。2列目以降は無視。</p>
<div id="msStatus" class="small">未読込</div>
</div>


<div class="card">
<h2>③ 抽出＆照合</h2>
<div class="row">
<button id="btnRun" type="button">抽出 → 照合 → 結果表示</button>
<span id="runStatus" class="small"></span>
</div>
<textarea id="rawText" placeholder="抽出テキスト（デバッグ用）" class="mono"></textarea>
</div>


<div class="card">
<h2>④ 結果</h2>
<div class="row">
<button id="btnExportXlsx" type="button">一致リストを XLSX で保存</button>
<button id="btnExportCsv" type="button">一致リストを CSV で保存</button>
</div>
<h3>一致（MSに存在）</h3>
<textarea id="matched" class="mono"></textarea>
<h3>未一致（要確認）</h3>
<textarea id="unmatched" class="mono"></textarea>
</div>
</div>


<p class="small">ver: ms-refined-2025-09 • 文字整形は normalize.js / 抽出は ass.js / 制御は app.js</p>
</div>
</body>
</html>
*/
